# Browser Artifacts

ï¼ƒæµè§ˆå™¨å·¥ä»¶

<details>

<summary><strong>Support HackTricks and get benefits!</strong></summary>

<summary> <strong>æ”¯æŒhacktrickså¹¶è·å¾—å¥½å¤„ï¼</strong> </summary>

- Do you work in a **cybersecurity company**? Do you want to see your **company advertised in HackTricks**? or do you want to have access to the **latest version of the PEASS or download HackTricks in PDF**? Check the [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!

 - æ‚¨åœ¨**ç½‘ç»œå®‰å…¨å…¬å¸**å·¥ä½œå—ï¼Ÿ æ‚¨æ˜¯å¦æƒ³çœ‹åˆ°æ‚¨çš„**å…¬å¸åœ¨hacktricks **ä¸­åˆŠç™»å¹¿å‘Šï¼Ÿ è¿˜æ˜¯æ‚¨æƒ³è®¿é—®**æœ€æ–°ç‰ˆæœ¬çš„è±Œè±†æˆ–åœ¨pdf **ä¸­ä¸‹è½½hacktricksï¼Ÿ æ£€æŸ¥[**è®¢é˜…è®¡åˆ’**]ï¼ˆhttps://github.com/sponsors/carlospolopï¼‰ï¼

- Discover [**The PEASS Family**](https://opensea.io/collection/the-peass-family), our collection of exclusive [**NFTs**](https://opensea.io/collection/the-peass-family)

 - å‘ç°[**è±Œè±†å®¶åº­**]ï¼ˆhttps://opensea.io/collection/the-peass-familyï¼‰ï¼Œæˆ‘ä»¬çš„ç‹¬å®¶[** nfts **]ï¼ˆhttps://opensea.io/collectionï¼‰ /å®¶åº­å®¶åº­ï¼‰

- Get the [**official PEASS & HackTricks swag**](https://peass.creator-spring.com)

 - è·å–[**å®˜æ–¹è±Œè±†å’Œhacktricksèµƒç‰©**]ï¼ˆhttps://peass.creator-spring.comï¼‰

- **Join the** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** me on **Twitter** [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/carlospolopm)**.**

 -  **åŠ å…¥** [**ğŸ’¬**]ï¼ˆhttps://emojipedia.org/speech-balloon/ï¼‰[** discord group **]ï¼ˆhttps://discord.gg/hrep4ruj7fï¼‰æˆ–[ **ç”µæŠ¥ç»„**]ï¼ˆhttps://t.me/peassï¼‰æˆ–**åœ¨** Twitter ** [**ğŸ¦**]ï¼ˆhttps://github.com/carloppolop/hacktrickss on ** twitter **ï¼‰ /ree/7af18b62b3bdc423e114444444677a6a73d4043511e9/ \ [https:/emojipedia.org/bird/bird/readme.mdï¼‰eardme.mdï¼‰eghterme.mdï¼‰eghterme.mdï¼‰eghterme.mdï¼‰eghtemplopmbyth

- **Share your hacking tricks by submitting PRs to the** [**hacktricks github repo**](https://github.com/carlospolop/hacktricks)**.**

 -  **é€šè¿‡å°†PRSæäº¤ç»™** [** hacktricks github repo **]ï¼ˆhttps://github.com/carloppolop/hacktricksï¼‰**ã€‚

</details>

{% hint style="danger" %}
<img src="../../../.gitbook/assets/image (307).png" alt="" data-size="original">

<img src =â€œ../../../ã€‚gitbook/assets/imageï¼ˆ307ï¼‰.pngâ€œ alt =â€â€œ data-size =â€ ointers =â€œ ointersâ€>
Through Security Skills as a Service, we help organizations to **defend against the Dark Hacking Arts**. Security Skills as a Service is an offensive cybersecurity consultancy model that combines an Intelligent Platform with the top-class, globally distributed, offensive security engineers, delivering **high-quality penetration testing results. Security Hubs** bring together offensive penetration testing tactics with human behavioral science, providing real-time insights into threat actors' tradecraft and a **complete assessment of any risks**.

é€šè¿‡å®‰å…¨æŠ€èƒ½ä½œä¸ºæœåŠ¡ï¼Œæˆ‘ä»¬å¸®åŠ©ç»„ç»‡**é˜²å¾¡é»‘æš—é»‘å®¢è‰ºæœ¯**ã€‚ å®‰å…¨æŠ€èƒ½ä½œä¸ºæœåŠ¡æ˜¯ä¸€ç§è¿›æ”»æ€§ç½‘ç»œå®‰å…¨å’¨è¯¢æ¨¡å‹ï¼Œå°†æ™ºèƒ½å¹³å°ä¸é¡¶çº§ï¼Œå…¨çƒåˆ†å¸ƒå¼ï¼Œè¿›æ”»æ€§å®‰å…¨å·¥ç¨‹å¸ˆç»“åˆåœ¨ä¸€èµ·ï¼Œæä¾›**é«˜è´¨é‡çš„æ¸—é€æµ‹è¯•ç»“æœã€‚ å®‰å…¨æ¢çº½**å°†è¿›æ”»æ€§æ¸—é€æµ‹è¯•ç­–ç•¥ä¸äººç±»è¡Œä¸ºç§‘å­¦ç»“åˆåœ¨ä¸€èµ·ï¼Œæä¾›å¯¹å¨èƒå‚ä¸è€…è´¸æ˜“å…‹ç½—å¤«ç‰¹ï¼ˆTradecraftï¼‰çš„å®æ—¶è§è§£ï¼Œå¹¶å¯¹ä»»ä½•é£é™©**è¿›è¡Œå®Œæ•´è¯„ä¼°ã€‚

{% embed url="https://securityhubs.io/" %}
{% endhint %}

## Browsers Artifacts <a href="#3def" id="3def"></a>

##æµè§ˆå™¨æ–‡ç‰©<a href="#3def" id="3def"> </a>

When we talk about browser artifacts we talk about, navigation history, bookmarks, list of downloaded files, cache data, etc.

å½“æˆ‘ä»¬è°ˆè®ºæµè§ˆå™¨å·¥ä»¶æ—¶ï¼Œæˆ‘ä»¬è°ˆè®ºçš„æ˜¯ï¼Œå¯¼èˆªå†å²è®°å½•ï¼Œä¹¦ç­¾ï¼Œä¸‹è½½æ–‡ä»¶åˆ—è¡¨ï¼Œç¼“å­˜æ•°æ®ç­‰ã€‚

These artifacts are files stored inside specific folders in the operating system.

è¿™äº›å·¥ä»¶æ˜¯æ“ä½œç³»ç»Ÿä¸­ç‰¹å®šæ–‡ä»¶å¤¹ä¸­å­˜å‚¨çš„æ–‡ä»¶ã€‚

Each browser stores its files in a different place than other browsers and they all have different names, but they all store (most of the time) the same type of data (artifacts).

æ¯ä¸ªæµè§ˆå™¨å°†å…¶æ–‡ä»¶å­˜å‚¨åœ¨ä¸å…¶ä»–æµè§ˆå™¨ä¸åŒçš„ä½ç½®ï¼Œå¹¶ä¸”å®ƒä»¬éƒ½æœ‰ä¸åŒçš„åç§°ï¼Œä½†æ˜¯å®ƒä»¬ï¼ˆå¤§å¤šæ•°æ—¶å€™ï¼‰éƒ½å­˜å‚¨äº†ç›¸åŒç±»å‹çš„æ•°æ®ï¼ˆä¼ªåƒï¼‰ã€‚

Let us take a look at the most common artifacts stored by browsers.

è®©æˆ‘ä»¬çœ‹ä¸€ä¸‹æµè§ˆå™¨å­˜å‚¨çš„æœ€å¸¸è§çš„æ–‡ç‰©ã€‚

* **Navigation History:** Contains data about the navigation history of the user. Can be used to track down if the user has visited some malicious sites for example

***å¯¼èˆªå†å²è®°å½•ï¼š**åŒ…å«æœ‰å…³ç”¨æˆ·å¯¼èˆªå†å²è®°å½•çš„æ•°æ®ã€‚ å¯ä»¥ç”¨ç”¨æˆ·è®¿é—®è¿‡ä¸€äº›æ¶æ„ç½‘ç«™æ¥è¿½è¸ª
* **Autocomplete Data:** This is the data that the browser suggests based on what you search for the most. Can be used in tandem with the navigation history to get more insight.

***è‡ªåŠ¨å®Œæˆæ•°æ®ï¼š**è¿™æ˜¯æµè§ˆå™¨æ ¹æ®æ‚¨æœ€å¤šæœç´¢çš„æ•°æ®æ‰€å»ºè®®çš„æ•°æ®ã€‚ å¯ä»¥ä¸å¯¼èˆªå†å²è®°å½•åŒæ—¶ä½¿ç”¨ä»¥è·å¾—æ›´å¤šçš„è§è§£ã€‚
* **Bookmarks:** Self Explanatory.

***ä¹¦ç­¾ï¼š**è‡ªæˆ‘è§£é‡Šã€‚
* **Extensions and Add ons:** Self Explanatory.

***æ‰©å±•å¹¶æ·»åŠ å¯åŠ¨ï¼š**è‡ªæˆ‘è§£é‡Šã€‚
* **Cache:** When navigating websites, the browser creates all sorts of cache data (images, javascript filesâ€¦etc) for many reasons. For example to speed the loading time of websites. These cache files can be a great source of data during a forensic investigation.

***ç¼“å­˜ï¼š**å¯¼èˆªç½‘ç«™æ—¶ï¼Œæµè§ˆå™¨å‡ºäºè®¸å¤šåŸå› è€Œåˆ›å»ºå„ç§ç¼“å­˜æ•°æ®ï¼ˆå›¾åƒï¼ŒJavaScriptæ–‡ä»¶ç­‰ï¼‰ã€‚ ä¾‹å¦‚ï¼ŒåŠ å¿«ç½‘ç«™çš„åŠ è½½æ—¶é—´ã€‚ è¿™äº›ç¼“å­˜æ–‡ä»¶å¯ä»¥æ˜¯æ³•åŒ»è°ƒæŸ¥æœŸé—´çš„é‡è¦æ•°æ®æ¥æºã€‚
* **Logins:** Self Explanatory.

***ç™»å½•ï¼š**è‡ªæˆ‘è§£é‡Šã€‚
* **Favicons:** They are the little icons found in tabs, urls, bookmarks and the such. They can be used as another source to get more information about the website or places the user visited.

*** faviconsï¼š**å®ƒä»¬æ˜¯æ ‡ç­¾ï¼ŒURLï¼Œä¹¦ç­¾ç­‰ä¸­å‘ç°çš„å°å›¾æ ‡ã€‚ å®ƒä»¬å¯ä»¥ç”¨ä½œå¦ä¸€ä¸ªæ¥æºï¼Œä»¥è·å–æœ‰å…³è¯¥ç½‘ç«™æˆ–è®¿é—®ç”¨æˆ·è®¿é—®çš„æ›´å¤šä¿¡æ¯ã€‚
* **Browser Sessions:** Self Explanatory.

***æµè§ˆå™¨ä¼šè®®ï¼š**è‡ªæˆ‘è§£é‡Šã€‚
* **Downloads:**Self Explanatory.

***ä¸‹è½½ï¼š**è‡ªæˆ‘è§£é‡Šã€‚
* **Form Data:** Anything typed inside forms is oftentimes stored by the browser, so the next time the user enters something inside of a form the browser can suggest previously entered data.

***è¡¨å•æ•°æ®ï¼š**æµè§ˆå™¨é€šå¸¸ä¼šå­˜å‚¨å†…éƒ¨è¡¨å•å†…éƒ¨çš„ä»»ä½•å†…å®¹ï¼Œå› æ­¤ï¼Œä¸‹ä¸€æ¬¡ç”¨æˆ·åœ¨æµè§ˆå™¨ä¸­å¯ä»¥å»ºè®®å…ˆå‰è¾“å…¥çš„æ•°æ®çš„è¡¨å•ä¸­è¾“å…¥æŸäº›å†…å®¹æ—¶ã€‚
* **Thumbnails:** Self Explanatory.

***ç¼©ç•¥å›¾ï¼š**è‡ªæˆ‘è§£é‡Šã€‚

## Firefox

## Firefox

Firefox 	create the profiles folder in \~/_**.mozilla/firefox/**_ (Linux), in **/Users/$USER/Library/Application Support/Firefox/Profiles/** (MacOS), _**%userprofile%\AppData\Roaming\Mozilla\Firefox\Profiles\\**_ (Windows)_**.**_\

Firefoxåœ¨\ã€œ/_ **ä¸­åˆ›å»ºé…ç½®æ–‡ä»¶å¤¹ã€‚mozilla/firefox/** _ï¼ˆlinuxï¼‰ï¼Œin **/user/$ user/library/library/application/firefox/profiles/**ï¼ˆmacOSï¼‰ï¼Œ_** *ï¼…userProfileï¼…\ appdata \ roaming \ mozilla \ firefox \ profiles \\ ** _ï¼ˆwindowsï¼‰_ **ã€‚** _ \ _ \
Inside this folder, the file _**profiles.ini**_ should appear with the name(s) of the user profile(s).\

åœ¨æ­¤æ–‡ä»¶å¤¹ä¸­ï¼Œæ–‡ä»¶_ ** profiles.ini ** _åº”è¯¥ä»¥ç”¨æˆ·é…ç½®æ–‡ä»¶çš„åç§°å‡ºç°ã€‚\ \ \
Each profile has a "**Path**" variable with the name of the folder where its data is going to be stored. The folder should be **present in the same directory where the \_profiles.ini**\_\*\* exist\*\*. If it isn't, then, probably it was deleted.

æ¯ä¸ªé…ç½®æ–‡ä»¶éƒ½æœ‰ä¸€ä¸ªâ€œ **è·¯å¾„**â€å˜é‡ï¼Œå¹¶å…·æœ‰å°†å­˜å‚¨æ•°æ®çš„æ–‡ä»¶å¤¹çš„åç§°ã€‚ è¯¥æ–‡ä»¶å¤¹åº”åœ¨åŒä¸€ç›®å½•ä¸­å­˜åœ¨**ï¼Œå…¶ä¸­\ _profiles.ini ** \ _ \*\*å­˜åœ¨\*\*ã€‚ å¦‚æœä¸æ˜¯è¿™æ ·ï¼Œé‚£ä¹ˆå®ƒå¯èƒ½å·²è¢«åˆ é™¤ã€‚

Inside the folder **of each profile** (_\~/.mozilla/firefox/\<ProfileName>/_) path you should be able to find the following interesting files:

åœ¨æ¯ä¸ªé…ç½®æ–‡ä»¶çš„æ–‡ä»¶å¤¹**å†…éƒ¨**ï¼ˆ_ \ã€œ/.mozilla/firefox/\ <prifilename>/_ï¼‰è·¯å¾„æ‚¨åº”è¯¥èƒ½å¤Ÿæ‰¾åˆ°ä»¥ä¸‹æœ‰è¶£çš„æ–‡ä»¶ï¼š

* _**places.sqlite**_ : History (moz\_\_places), bookmarks (moz\_bookmarks), and downloads (moz\_\_annos). In Windows the tool [BrowsingHistoryView](https://www.nirsoft.net/utils/browsing\_history\_view.html) can be used to read the history inside _**places.sqlite**_.

*_ ** ploce.sqlite ** _ï¼šå†å²è®°å½•ï¼ˆmoz \ _ \ _ placeï¼‰ï¼Œä¹¦ç­¾ï¼ˆmoz \ _ bookmarksï¼‰å’Œä¸‹è½½ï¼ˆmoz \ _ \ _ annosï¼‰ã€‚ åœ¨Windowsä¸­ï¼Œå·¥å…·[browsinghistoryview]ï¼ˆhttps://www.nirsoft.net/utils/browsing \ _history \ _view.htmlï¼‰å¯ç”¨äºè¯»å–_ ** place.sqlite ** _ _ _ _ _ _ _çš„å†å²è®°å½•ã€‚
  * Query to dump history: `select datetime(lastvisitdate/1000000,'unixepoch') as visit_date, url, title, visit_count, visit_type FROM moz_places,moz_historyvisits WHERE moz_places.id = moz_historyvisits.place_id;`

*æŸ¥è¯¢è½¬å‚¨å†å²è®°å½•ï¼š`select dateTimeï¼ˆlastVisitDate/1000000ï¼Œ'unixepoch'ï¼‰ä½œä¸ºvisit_dateï¼Œurlï¼Œurlï¼Œtitleï¼Œtitleï¼Œtitleï¼Œcoot_countï¼Œvisit_typeï¼Œmoz_historyvisitsï¼Œmoz_historyvisitsï¼Œmoz__places.id = moz_ishistoryvisits.shistoryvisits.place_id;
    * Note that a link type is a number that indicates:

*è¯·æ³¨æ„ï¼Œé“¾æ¥ç±»å‹æ˜¯æŒ‡ç¤ºï¼š
      * 1: User followed a link

* 1ï¼šç”¨æˆ·éµå¾ªé“¾æ¥
      * 2: User wrote the URL

* 2ï¼šç”¨æˆ·å†™äº†URL
      * 3: User used a favorite

* 3ï¼šç”¨æˆ·ä½¿ç”¨äº†å–œæ¬¢çš„
      * 4: Loaded from Iframe

* 4ï¼šä»iframeåŠ è½½
      * 5: Accessed via HTTP redirect 301

* 5ï¼šé€šè¿‡HTTPé‡å®šå‘301è®¿é—®
      * 6: Accessed via HTTP redirect 302

* 6ï¼šé€šè¿‡HTTPé‡å®šå‘è®¿é—®302
      * 7: Downloaded file

* 7ï¼šä¸‹è½½æ–‡ä»¶
      * 8: User followed a link inside an Iframe

* 8ï¼šç”¨æˆ·éµå¾ªiframeä¸­çš„é“¾æ¥
  * Query to dump downloads: `SELECT datetime(lastModified/1000000,'unixepoch') AS down_date, content as File, url as URL FROM moz_places, moz_annos WHERE moz_places.id = moz_annos.place_id;`

*æŸ¥è¯¢è¦è½¬å‚¨ä¸‹è½½ï¼š`select dateTimeï¼ˆlastModified/1000000ï¼Œ'unixepoch'ï¼‰as down_dateï¼Œcontent as fileï¼Œurlä¸ºmoz_annosï¼Œmoz_annosï¼Œmoz_annos where moz_annos.id = moz_annos.place_id;
  *
* _**bookmarkbackups/**_ : Bookmarks backups

*_ ** bookmarkbackups/** _ï¼šä¹¦ç­¾å¤‡ä»½* _**formhistory.sqlite**_ : **Web form data** (like emails)

*_ ** formhistory.sqlite ** _ï¼š** Webè¡¨å•æ•°æ®**ï¼ˆå¦‚ç”µå­é‚®ä»¶ï¼‰
* _**handlers.json**_ : Protocol handlers (like, which app is going to handle _mailto://_ protocol)

*_ ** handlers.json ** _ï¼šåè®®å¤„ç†ç¨‹åºï¼ˆå°±åƒï¼Œå“ªä¸ªåº”ç”¨ç¨‹åºè¦å¤„ç†_mailtoï¼š// _ stoloceï¼‰
* _**persdict.dat**_ : Words added to the dictionary

*_ ** persdict.dat ** _ï¼šæ·»åŠ åˆ°å­—å…¸ä¸­çš„å•è¯
* _**addons.json**_ and \_**extensions.sqlite** \_ : Installed addons and extensions

*_ ** addons.json ** _ and \ _ ** Extensions.sqlite ** \ _ï¼šå·²å®‰è£…addonså’ŒExtensions
* _**cookies.sqlite**_ : Contains **cookies.** [**MZCookiesView**](https://www.nirsoft.net/utils/mzcv.html) can be used in Windows to inspect this file.

*_ ** cookies.sqlite ** _ï¼šåŒ…å«** cookiesã€‚ æ–‡ä»¶ã€‚
*   _**cache2/entries**_ or _**startupCache**_ : Cache data (\~350MB). Tricks like **data carving** can also be used to obtain the files saved in the cache. [MozillaCacheView](https://www.nirsoft.net/utils/mozilla\_cache\_viewer.html) can be used to see the **files saved in the cache**.

*_ ** cache2/entries ** _æˆ–_ ** startupcache ** _ï¼šç¼“å­˜æ•°æ®ï¼ˆ\ ã€œ350mbï¼‰ã€‚ è¯¸å¦‚**æ•°æ®é›•åˆ»**ä¹‹ç±»çš„æŠ€å·§ä¹Ÿå¯ç”¨äºè·å–ç¼“å­˜ä¸­ä¿å­˜çš„æ–‡ä»¶ã€‚ [mozillacacheview]ï¼ˆhttps://www.nirsoft.net/utils/mozilla/mozilla \ _cache_viewer.htmlï¼‰å¯ç”¨äºæŸ¥çœ‹ä¿å­˜åœ¨ç¼“å­˜ä¸­çš„**æ–‡ä»¶ã€‚

    Information that can be obtained:

å¯ä»¥è·å¾—çš„ä¿¡æ¯ï¼š

    * URL, fetch Count, Filename, Content type, File size, Last modified time, Last fetched time, Server Last Modified, Server Response

* URLï¼Œè·å–è®¡æ•°ï¼Œæ–‡ä»¶åï¼Œå†…å®¹ç±»å‹ï¼Œæ–‡ä»¶å¤§å°ï¼Œæœ€åä¿®æ”¹æ—¶é—´ï¼Œæœ€åè·å–æ—¶é—´ï¼ŒæœåŠ¡å™¨æœ€åä¿®æ”¹ï¼ŒæœåŠ¡å™¨å“åº”
* _**favicons.sqlite**_ : Favicons
* _**prefs.js**_ : Settings and Preferences

*_ ** prefs.js ** _ï¼šè®¾ç½®å’Œé¦–é€‰é¡¹
* _**downloads.sqlite**_ : Old downloads database (now it's inside places.sqlite)

*_ ** downloads.sqlite ** _ï¼šæ—§ä¸‹è½½æ•°æ®åº“ï¼ˆç°åœ¨å®ƒåœ¨inside ploces.sqliteï¼‰
* _**thumbnails/**_ : Thumbnails

*_ **ç¼©ç•¥å›¾/** _ï¼šç¼©ç•¥å›¾
* _**logins.json**_ : Encrypted usernames and passwords

*_ ** logins.json ** _ï¼šåŠ å¯†ç”¨æˆ·åå’Œå¯†ç 
* **Browserâ€™s built-in anti-phishing:** `grep 'browser.safebrowsing' ~/Library/Application Support/Firefox/Profiles/*/prefs.js`

***æµè§ˆå™¨çš„å†…ç½®åæ•æï¼š**``grep'Browser.safebrowsing'ã€œ/Library/Application Support/firfox/profiles/prefiles/prefs.js`
  * Will return â€œsafebrowsing.malware.enabledâ€ and â€œphishing.enabledâ€ as false if the safe search settings have been disabled

*å¦‚æœå®‰å…¨æœç´¢è®¾ç½®å·²è¢«ç¦ç”¨
* _**key4.db**_ or _**key3.db**_ : Master key?

To try to decrypt the master password, you can use [https://github.com/unode/firefox\_decrypt](https://github.com/unode/firefox\_decrypt)\

è¦å°è¯•è§£å¯†ä¸»å¯†ç ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨[https://github.com/unode/firefox \ _decrypt]ï¼ˆhttps://github.com/unode/firefox \ _decryptï¼‰\
With the following script and call you can specify a password file to brute force:

ä½¿ç”¨ä»¥ä¸‹è„šæœ¬å¹¶è‡´ç”µæ‚¨å¯ä»¥æŒ‡å®šå¯†ç æ–‡ä»¶ä»¥è¿åå¼ºåˆ¶ï¼š

{% code title="brute.sh" %}

{ï¼…ä»£ç æ ‡é¢˜=â€œ brute.shâ€ï¼…}
```bash
#!/bin/bash

#./brute.sh top-passwords.txt 2>/dev/null | grep -A2 -B2 "chrome:"
passfile=$1
while read pass; do
  echo "Trying $pass"
  echo "$pass" | python firefox_decrypt.py
done < $passfile
```
{% endcode %}

![](<../../../.gitbook/assets/image (417).png>)

## Google Chrome

ï¼ƒï¼ƒ è°·æ­Œæµè§ˆå™¨

Google Chrome creates the profile inside the home of the user _**\~/.config/google-chrome/**_ (Linux), in _**C:\Users\XXX\AppData\Local\Google\Chrome\User Data\\**_ (Windows), or in \_**/Users/$USER/Library/Application Support/Google/Chrome/** \_ (MacOS).\

Google Chromeåœ¨ç”¨æˆ·å®¶åº­å†…éƒ¨åˆ›å»ºé…ç½®æ–‡ä»¶_ ** \ã€œ/.config/google-chrome/** _ï¼ˆlinuxï¼‰ï¼Œin _ ** cï¼š\ users \ users \ xxx \ appdata \ appdata \ local \ local \ google \ google \ chrome \ chrome \ chrome \ chrome \ ç”¨æˆ·æ•°æ®\\ ** _ï¼ˆWindowsï¼‰æˆ–in \ _ **/user/$ user/library/application/google/chrome/** \ _ï¼ˆmacosï¼‰ã€‚
Most of the information will be saved inside the _**Default/**_ or _**ChromeDefaultData/**_ folders inside the paths indicated before. Here you can find the following interesting files:

å¤§å¤šæ•°ä¿¡æ¯å°†ä¿å­˜åœ¨_ **é»˜è®¤/** _æˆ–_ ** chromedefaultdata/** _ _ _ ** _ _æ–‡ä»¶å¤¹ä¸­ã€‚ åœ¨è¿™é‡Œï¼Œæ‚¨å¯ä»¥æ‰¾åˆ°ä»¥ä¸‹æœ‰è¶£çš„æ–‡ä»¶ï¼š

* _**History**_: URLs, downloads and even searched keywords. In Windows, you can use the tool [ChromeHistoryView](https://www.nirsoft.net/utils/chrome\_history\_view.html) to read the history. The "Transition Type" column means:

*_ **å†å²** _ï¼šURLï¼Œä¸‹è½½ç”šè‡³æœç´¢çš„å…³é”®å­—ã€‚ åœ¨Windowsä¸­ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨å·¥å…·[ChromehistoryView]ï¼ˆhttps://www.nirsoft.net/utils/chrome \_history \_View.htmlï¼‰é˜…è¯»å†å²è®°å½•ã€‚ â€œè¿‡æ¸¡ç±»å‹â€åˆ—çš„æ„æ€æ˜¯ï¼š
  * Link: User clicked on a link

*é“¾æ¥ï¼šç”¨æˆ·å•å‡»é“¾æ¥
  * Typed: The url was written

*é”®å…¥ï¼šç¼–å†™URL
  * Auto Bookmark

*è‡ªåŠ¨ä¹¦ç­¾
  * Auto Subframe: Add

  * Auto Subframe: Add
  * Start page: Home page
  * Form Submit: A form was filled and sent

*è¡¨æ ¼æäº¤ï¼šå¡«å†™è¡¨æ ¼å¹¶å‘é€
  * Reloaded

*é‡æ–°åŠ è½½
* _**Cookies**_: Cookies. [ChromeCookiesView](https://www.nirsoft.net/utils/chrome\_cookies\_view.html) can be used to inspect the cookies.

*_ ** cookies ** _ï¼šcookieã€‚ [ChromeCookiesView]ï¼ˆhttps://www.nirsoft.net/utils/chrome \_cookies \_View.htmlï¼‰å¯ç”¨äºæ£€æŸ¥cookieã€‚
* _**Cache**_: Cache. In Windows, you can use the tool [ChromeCacheView](https://www.nirsoft.net/utils/chrome\_cache\_view.html) to inspect the ca

*_ **ç¼“å­˜** _ï¼šç¼“å­˜ã€‚ åœ¨Windowsä¸­ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨å·¥å…·[ChromeCacheview]ï¼ˆhttps://www.nirsoft.net/utils/chrome \ _cache_view.htmlï¼‰æ£€æŸ¥CA
* _**Bookmarks**_: Bookmarks
* _**Web Data**_: Form History

*_ **ç½‘ç»œæ•°æ®** _ï¼šå½¢å¼å†å²è®°å½•
* _**Favicons**_: Favicons
* _**Login Data**_: Login information (usernames, passwords...)

*_ **ç™»å½•æ•°æ®** _ï¼šç™»å½•ä¿¡æ¯ï¼ˆç”¨æˆ·åï¼Œå¯†ç ...ï¼‰
* _**Current Session**_ and _**Current Tabs**_: Current session data and current tabs

*_ **å½“å‰ä¼šè¯** _å’Œ_ **å½“å‰é€‰é¡¹å¡** _ï¼šå½“å‰ä¼šè¯æ•°æ®å’Œå½“å‰é€‰é¡¹å¡
* _**Last Session**_ and _**Last Tabs**_: These files hold sites that were active in the browser when Chrome was last closed.

*_ **ä¸Šæ¬¡ä¼šè¯** _å’Œ_ **æœ€åä¸€ä¸ªé€‰é¡¹å¡** _ï¼šè¿™äº›æ–‡ä»¶åœ¨Chromeä¸Šä¸€æ¬¡å…³é—­æ—¶ä¿å­˜åœ¨æµè§ˆå™¨ä¸­æ´»è·ƒçš„ç«™ç‚¹ã€‚
* _**Extensions**_: Extensions and addons folder

*_ **æ‰©å±•** _ï¼šæ‰©å±•å’Œæ’ä»¶æ–‡ä»¶å¤¹
* **Thumbnails** : Thumbnails

***ç¼©ç•¥å›¾**ï¼šç¼©ç•¥å›¾
* **Preferences**: This file contains a plethora of good information such as plugins, extensions, sites using geolocation, popups, notifications, DNS prefetching, certificate exceptions, and much more. If youâ€™re trying to research whether or not a specific Chrome setting was enabled, you will likely find that setting in here.

***é¦–é€‰é¡¹**ï¼šæ­¤æ–‡ä»¶åŒ…å«å¾ˆå¤šå¥½çš„ä¿¡æ¯ï¼Œä¾‹å¦‚æ’ä»¶ï¼Œæ‰©å±•ï¼Œä½¿ç”¨åœ°ç†ä½ç½®ï¼Œå¼¹å‡ºå¼ï¼Œé€šçŸ¥ï¼ŒDNSé¢„å–ï¼Œé¢„å–ï¼Œè¯ä¹¦å¼‚å¸¸ç­‰ç­‰ã€‚ å¦‚æœæ‚¨æƒ³ç ”ç©¶æ˜¯å¦å¯ç”¨äº†ç‰¹å®šçš„é•€é“¬è®¾ç½®ï¼Œåˆ™å¯èƒ½ä¼šåœ¨æ­¤å¤„æ‰¾åˆ°è¯¥è®¾ç½®ã€‚
* **Browserâ€™s built-in anti-phishing:** `grep 'safebrowsing' ~/Library/Application Support/Google/Chrome/Default/Preferences`

***æµè§ˆå™¨çš„å†…ç½®åæ•æï¼š**``grep'safebrowsing'ã€œ/library/application supports/google/chrome/default/prefinessâ€œ
  * You can simply grep for â€œ**safebrowsing**â€ and look for `{"enabled: true,"}` in the result to indicate anti-phishing and malware protection is on.

*æ‚¨å¯ä»¥ç®€å•åœ°è¿›è¡Œâ€œ ** SafeBrowsing **â€ï¼Œç„¶åæŸ¥æ‰¾``'emabledï¼štrueï¼Œtrue'}`}`åœ¨ç»“æœæŒ‡ç¤ºåå‘é’“é±¼å’Œæ¶æ„è½¯ä»¶ä¿æŠ¤çš„æƒ…å†µä¸‹ã€‚

## **SQLite DB Data Recovery**

## ** sqlite DBæ•°æ®æ¢å¤**

As you can observe in the previous sections, both Chrome and Firefox use **SQLite** databases to store the data. It's possible to **recover deleted entries using the tool** [**sqlparse**](https://github.com/padfoot999/sqlparse) **or** [**sqlparse\_gui**](https://github.com/mdegrazia/SQLite-Deleted-Records-Parser/releases).

å¦‚æ‚¨åœ¨å‰é¢çš„éƒ¨åˆ†ä¸­å¯ä»¥è§‚å¯Ÿåˆ°çš„ï¼ŒChromeå’ŒFirefoxéƒ½ä½¿ç”¨** sqlite **æ•°æ®åº“å­˜å‚¨æ•°æ®ã€‚ å¯ä»¥ä½¿ç”¨è¯¥å·¥å…·** [** sqlparse **]ï¼ˆhttps://github.com/padfoot9999/sqlparseï¼‰**æ¢å¤å·²åˆ é™¤çš„æ¡ç›®**æˆ–** [** SQLPARSE \ _GUI **]ï¼ˆhttpsï¼š //github.com/mdegrazia/sqlite-deleted-records-parser/releasesï¼‰ã€‚

## **Internet Explorer 11**

Internet Explorer stores **data** and **metadata** in different locations. The metadata will allow finding the data.

Internet Explorerå­˜å‚¨**æ•°æ®**å’Œ**å…ƒæ•°æ®**åœ¨ä¸åŒçš„ä½ç½®ã€‚ å…ƒæ•°æ®å°†å…è®¸æŸ¥æ‰¾æ•°æ®ã€‚

The **metadata** can be found in the folder `%userprofile%\Appdata\Local\Microsoft\Windows\WebCache\WebcacheVX.data` where VX can be V01, V16, or V24.\

**å…ƒæ•°æ®**å¯ä»¥åœ¨æ–‡ä»¶å¤¹`ï¼…userProfileï¼…\ appdata \ local \ microsoft \ windows \ windows \ webcache \ webcache \ webcachevx.data`ä¸­æ‰¾åˆ°ï¼Œå…¶ä¸­vxå¯ä»¥ä¸ºv01ï¼Œv16æˆ–v24ã€‚
In the previous folder, you can also find the file V01.log. In case the **modified time** of this file and the WebcacheVX.data file **are different** you may need to run the command `esentutl /r V01 /d` to **fix** possible **incompatibilities**.

åœ¨ä¸Šä¸€ä¸ªæ–‡ä»¶å¤¹ä¸­ï¼Œæ‚¨è¿˜å¯ä»¥æ‰¾åˆ°æ–‡ä»¶v01.logã€‚ å¦‚æœæ­¤æ–‡ä»¶çš„ä¿®æ”¹æ—¶é—´**å’Œwebcachevx.dataæ–‡ä»¶**ä¸åŒ** **æ‚¨å¯èƒ½éœ€è¦è¿è¡Œå‘½ä»¤`esentutl /r v01 /d` to ** fix ** fix **å¯èƒ½çš„**æ— å…¼å®¹** ** *ã€‚

Once **recovered** this artifact (It's an ESE database, photorec can recover it with the options Exchange Database or EDB) you can use the program [ESEDatabaseView](https://www.nirsoft.net/utils/ese\_database\_view.html) to open it. Once **opened**, go to the table named "**Containers**".

ä¸€æ—¦**æ¢å¤** **æ­¤å·¥ä»¶ï¼ˆè¿™æ˜¯ä¸€ä¸ªESEæ•°æ®åº“ï¼ŒPhotorecå¯ä»¥ä½¿ç”¨é€‰é¡¹äº¤æ¢æ•°æ®åº“æˆ–EDBæ¢å¤å®ƒï¼‰æ‚¨å¯ä»¥ä½¿ç”¨ç¨‹åº[esedatabaseview]ï¼ˆhttps://wwwww.nirsoft.net.net.net.net/utils/ese \_database \ _view.htmlï¼‰æ‰“å¼€å®ƒã€‚ ä¸€æ—¦**æ‰“å¼€**ï¼Œè¯·è½¬åˆ°åä¸ºâ€œ **å®¹å™¨**â€çš„è¡¨ã€‚

![](<../../../.gitbook/assets/image (446).png>)

Inside this table, you can find in which other tables or containers each part of the stored information is saved. Following that, you can find the **locations of the data** stored by the browsers and the **metadata** that is inside.

åœ¨æ­¤è¡¨ä¸­ï¼Œæ‚¨å¯ä»¥æ‰¾åˆ°ä¿å­˜å­˜å‚¨ä¿¡æ¯çš„æ¯ä¸ªéƒ¨åˆ†çš„å…¶ä»–è¡¨æˆ–å®¹å™¨ã€‚ åœ¨æ­¤ä¹‹åï¼Œæ‚¨å¯ä»¥æ‰¾åˆ°ç”±æµè§ˆå™¨å’Œå†…éƒ¨çš„**å…ƒæ•°æ®**å­˜å‚¨çš„æ•°æ®**çš„**ä½ç½®ã€‚

**Note that this table indicates metadata of the cache for other Microsoft tools also (e.g. skype)**

**è¯·æ³¨æ„ï¼Œæ­¤è¡¨è¡¨ç¤ºå…¶ä»–Microsoftå·¥å…·çš„ç¼“å­˜å…ƒæ•°æ®ï¼ˆä¾‹å¦‚Skypeï¼‰**

### Cache

###ç¼“å­˜

You can use the tool [IECacheView](https://www.nirsoft.net/utils/ie\_cache\_viewer.html) to inspect the cache. You need to indicate the folder where you have extracted the cache date.

æ‚¨å¯ä»¥ä½¿ç”¨å·¥å…·[iecacheview]ï¼ˆhttps://www.nirsoft.net/utils/ie \_cache_viewer.htmlï¼‰æ£€æŸ¥ç¼“å­˜ã€‚ æ‚¨éœ€è¦æŒ‡ç¤ºå·²æå–ç¼“å­˜æ—¥æœŸçš„æ–‡ä»¶å¤¹ã€‚

#### Metadata

The metadata information about the cache stores:

æœ‰å…³ç¼“å­˜å•†åº—çš„å…ƒæ•°æ®ä¿¡æ¯ï¼š

* Filename in the disc

*å…‰ç›˜ä¸­çš„æ–‡ä»¶å
* SecureDIrectory: Location of the file inside the cache directories

*å®‰å…¨çº§ï¼šæ–‡ä»¶å†…éƒ¨çš„ä½ç½®
* AccessCount: Number of times it was saved in the cache

* AccessCountï¼šå°†å…¶ä¿å­˜åœ¨ç¼“å­˜ä¸­çš„æ¬¡æ•°
* URL: The url origin

* URLï¼šURLèµ·æº
* CreationTime: First time it was cached

*åˆ›å»ºæ—¶é—´ï¼šç¬¬ä¸€æ¬¡è¢«ç¼“å­˜
* AccessedTime: Time when the cache was used

*è®¿é—®æ—¶é—´ï¼šä½¿ç”¨ç¼“å­˜çš„æ—¶é—´
* ModifiedTime: Last webpage version

*ä¿®æ”¹æ—¶é—´ï¼šæœ€åä¸€ä¸ªç½‘é¡µç‰ˆæœ¬* ExpiryTime: Time when the cache will expire

*åˆ°æœŸæ—¶é—´ï¼šç¼“å­˜åˆ°æœŸçš„æ—¶é—´

#### Files

The cache information can be found in _**%userprofile%\Appdata\Local\Microsoft\Windows\Temporary Internet Files\Content.IE5**_ and _**%userprofile%\Appdata\Local\Microsoft\Windows\Temporary Internet Files\Content.IE5\low**_

å¯ä»¥åœ¨_ **ï¼…userProfileï¼…\ appdata \ local \ local \ Microsoft \ Windows \ Windows \ä¸´æ—¶Internet Files \ pontent.ie5 ** _ _ ** **ï¼…userProfileï¼…\ appdata \ localosoft \ Microsoft \ Windows \ Windows \ Windows \ä¸´æ—¶Internetä¸­æ‰¾åˆ°ç¼“å­˜ä¿¡æ¯ã€‚ æ–‡ä»¶\ content.ie5 \ low ** _

The information inside these folders is a **snapshot of what the user was seeing**. The caches have a size of **250 MB** and the timestamps indicate when the page was visited (first time, creation date of the NTFS, last time, modification time of the NTFS).

è¿™äº›æ–‡ä»¶å¤¹ä¸­çš„ä¿¡æ¯æ˜¯ç”¨æˆ·çœ‹åˆ°çš„**çš„**å¿«ç…§ã€‚ ç¼“å­˜çš„å¤§å°ä¸º** 250 MB **ï¼Œæ—¶é—´æˆ³è¡¨ç¤ºè¯¥é¡µé¢ä½•æ—¶è®¿é—®ï¼ˆç¬¬ä¸€æ¬¡ï¼ŒNTFSçš„åˆ›å»ºæ—¥æœŸï¼Œä¸Šæ¬¡ï¼ŒNTFSçš„ä¿®æ”¹æ—¶é—´ï¼‰ã€‚

### Cookies

You can use the tool [IECookiesView](https://www.nirsoft.net/utils/iecookies.html) to inspect the cookies. You need to indicate the folder where you have extracted the cookies.

æ‚¨å¯ä»¥ä½¿ç”¨å·¥å…·[iecookiesView]ï¼ˆhttps://www.nirsoft.net/utils/iecookies.htmlï¼‰æ£€æŸ¥cookieã€‚ æ‚¨éœ€è¦æŒ‡ç¤ºæå–cookieçš„æ–‡ä»¶å¤¹ã€‚

#### **Metadata**

The metadata information about the cookies stored:

æœ‰å…³å­˜å‚¨çš„cookieçš„å…ƒæ•°æ®ä¿¡æ¯ï¼š

* Cookie name in the filesystem

*æ–‡ä»¶ç³»ç»Ÿä¸­çš„cookieåç§°
* URL
* AccessCount: Number of times the cookies have been sent to the server

* AccessCountï¼šcookieå·²å‘é€åˆ°æœåŠ¡å™¨çš„æ¬¡æ•°
* CreationTime: First time the cookie was created

*åˆ›å»ºæ—¶é—´ï¼šç¬¬ä¸€æ¬¡åˆ›å»ºäº†cookie
* ModifiedTime: Last time the cookie was modified

*ä¿®æ”¹æ—¶é—´ï¼šä¸Šæ¬¡ä¿®æ”¹äº†cookie
* AccessedTime: Last time the cookie was accessed

*è®¿é—®æ—¶é—´ï¼šä¸Šæ¬¡è®¿é—®cookie
* ExpiryTime: Time of expiration of the cookie

*åˆ°æœŸæ—¶é—´ï¼šé¥¼å¹²åˆ°æœŸæ—¶é—´

#### Files

The cookies data can be found in _**%userprofile%\Appdata\Roaming\Microsoft\Windows\Cookies**_ and _**%userprofile%\Appdata\Roaming\Microsoft\Windows\Cookies\low**_

cookiesæ•°æ®å¯ä»¥åœ¨_ **ï¼…userProfileï¼…\ appdata \ roaming \ microsoft \ windows \ windows \ cookies ** _ _ and _ **ï¼…userProfileï¼…\ appdata \ roaming \ microsoft \ microsoft \ windows \ cookies \ cookies \ low ** _ _ _

Session cookies will reside in memory and persistent cookie in the disk.

ä¼šè¯cookieå°†ä½äºå†…å­˜ä¸­ï¼Œå¹¶åœ¨ç£ç›˜ä¸­æŒç»­cookieã€‚

### Downloads

###ä¸‹è½½

#### **Metadata**

Checking the tool [ESEDatabaseView](https://www.nirsoft.net/utils/ese\_database\_view.html) you can find the container with the metadata of the downloads:

æ£€æŸ¥å·¥å…·[esedatabaseview]ï¼ˆhttps://www.nirsoft.net/utils/ese \ _database \ _view.htmlï¼‰æ‚¨å¯ä»¥æ‰¾åˆ°å¸¦æœ‰ä¸‹è½½å…ƒæ•°æ®çš„å®¹å™¨ï¼š

![](<../../../.gitbook/assets/image (445).png>)

Getting the information of the column "ResponseHeaders" you can transform from hex that information and obtain the URL, the file type and the location of the downloaded file.

è·å–â€œ ResponseHeadersâ€åˆ—çš„ä¿¡æ¯æ‚¨å¯ä»¥ä»åå…­è¿›åˆ¶ä¿¡æ¯è½¬æ¢ï¼Œå¹¶è·å–å·²ä¸‹è½½æ–‡ä»¶çš„URLï¼Œæ–‡ä»¶ç±»å‹å’Œä½ç½®ã€‚

#### Files

Look in the path _**%userprofile%\Appdata\Roaming\Microsoft\Windows\IEDownloadHistory**_

æŸ¥çœ‹è·¯å¾„_ **ï¼…userProfileï¼…\ appdata \ roaming \ Microsoft \ Windows \ iedownloadhistory ** _ _

### **History**

ï¼ƒï¼ƒï¼ƒ **å†å²**

The tool [BrowsingHistoryView](https://www.nirsoft.net/utils/browsing\_history\_view.html) can be used to read the history. But first, you need to indicate the browser in advanced options and the location of the extracted history files.

å¯ä»¥ä½¿ç”¨å·¥å…·[browsinghistoryview]ï¼ˆhttps://www.nirsoft.net/utils/browsing \_history \ _view.htmlï¼‰æ¥è¯»å–å†å²è®°å½•ã€‚ ä½†æ˜¯é¦–å…ˆï¼Œæ‚¨éœ€è¦åœ¨é«˜çº§é€‰é¡¹å’Œæå–çš„å†å²è®°å½•æ–‡ä»¶çš„ä½ç½®ä¸­æŒ‡ç¤ºæµè§ˆå™¨ã€‚

#### **Metadata**

* ModifiedTime: First time a URL is found

*ä¿®æ”¹æ—¶é—´ï¼šç¬¬ä¸€æ¬¡æ‰¾åˆ°URL
* AccessedTime: Last time

*è®¿é—®æ—¶é—´ï¼šä¸Šæ¬¡
* AccessCount: Number of times accessed

* AccessCountï¼šè®¿é—®çš„æ¬¡æ•°

#### **Files**

Search in _**userprofile%\Appdata\Local\Microsoft\Windows\History\History.IE5**_ and _**userprofile%\Appdata\Local\Microsoft\Windows\History\Low\History.IE5**_

åœ¨_ ** _ ** userProfileï¼…\ appdata \ local \ Microsoft \ Windows \ Windows \ history \ history.ies.ie5 ** _å’Œ_ ** userProfileï¼…\ appdata \ local \ Microsoft \ Microsoft \ Windows \ Windows \ history \ history \ low \ low \ stistory.ie5 ** _ _

### **Typed URLs**

### **é”®å…¥URL **

This information can be found inside the registry NTDUSER.DAT in the path:

å¯ä»¥åœ¨æ³¨å†Œè¡¨ntduser.datä¸­æ‰¾åˆ°æ­¤ä¿¡æ¯ï¼š

* _**Software\Microsoft\InternetExplorer\TypedURLs**_

*_ **è½¯ä»¶\ Microsoft \ Internet Explorer \ typedurls ** _ _
  * Stores the last 50 URLs typed by the user

*å­˜å‚¨ç”¨æˆ·é”®å…¥çš„æœ€å50ä¸ªURL
* _**Software\Microsoft\InternetExplorer\TypedURLsTime**_

*_ **è½¯ä»¶\ Microsoft \ Internet Explorer \ typedurlstime ** _ _
  * last time the URL was typed

*ä¸Šæ¬¡URLé”®å…¥

## Microsoft Edge

## Microsoft Edge

For analyzing Microsoft Edge artifacts all the **explanations about cache and locations from the previous section (IE 11) remain valid** with the only difference that the base locating, in this case, is _**%userprofile%\Appdata\Local\Packages**_ (as can be observed in the following paths):

ä¸ºäº†åˆ†æMicrosoft Edgeä¼ªåƒï¼Œæœ‰å…³ç¼“å­˜çš„æ‰€æœ‰**è¯´æ˜å’Œä¸Šä¸€èŠ‚ï¼ˆå³11ï¼‰çš„ä½ç½®ï¼ˆå³11ï¼‰ä»ç„¶æœ‰æ•ˆ** **ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒåŸºæœ¬å®šä½æ˜¯_ **ï¼…userProfileï¼…\ appdata \ localçš„å”¯ä¸€åŒºåˆ« \ packages ** _ï¼ˆå¯ä»¥åœ¨ä»¥ä¸‹è·¯å¾„ä¸­è§‚å¯Ÿåˆ°ï¼‰ï¼š

* Profile Path: _**C:\Users\XX\AppData\Local\Packages\Microsoft.MicrosoftEdge\_XXX\AC**_

*é…ç½®æ–‡ä»¶è·¯å¾„ï¼š_ ** cï¼š\ users \ xx \ appdata \ local \ packages \ microsoft.microsoft. \ _xxx \ ac ** _ _
* History, Cookies and Downloads: _**C:\Users\XX\AppData\Local\Microsoft\Windows\WebCache\WebCacheV01.dat**_

*å†å²è®°å½•ï¼Œcookieå’Œä¸‹è½½ï¼š_ ** cï¼š\ users \ xx \ appdata \ local \ local \ microsoft \ windows \ windows \ webcache \ webcachev01.dat ** _ _
* Settings, Bookmarks, and Reading List: _**C:\Users\XX\AppData\Local\Packages\Microsoft.MicrosoftEdge\_XXX\AC\MicrosoftEdge\User\Default\DataStore\Data\nouser1\XXX\DBStore\spartan.edb**_

*è®¾ç½®ï¼Œä¹¦ç­¾å’Œé˜…è¯»åˆ—è¡¨ï¼š_ ** cï¼š\ç”¨æˆ·\ xx \ appdata \ local \ packages \ microsoft.microsoft.microsoftedge \ _xxx \ ac \ ac \ ac \ microsoftEdge \ microsoftEdge \ user \ user \ user \ default \ datastore \ datastore \ datastore \ dataStore \ datastore \ dataastore \ data \ nouser1 \ nouser1 \ xxx \ dbartan .edb ** _
* Cache: _**C:\Users\XXX\AppData\Local\Packages\Microsoft.MicrosoftEdge\_XXX\AC#!XXX\MicrosoftEdge\Cache**_

*ç¼“å­˜ï¼š_ ** cï¼š\ users \ xxx \ appdata \ local \ packages \ microsoft.microsoftEdge \ _xxx \ acï¼ƒï¼xxx \ microsoftEdge \ microsoftEdge \ cache ** _ _ _ _ _ _
* Last active sessions: _**C:\Users\XX\AppData\Local\Packages\Microsoft.MicrosoftEdge\_XXX\AC\MicrosoftEdge\User\Default\Recovery\Active**_

*ä¸Šæ¬¡æ´»åŠ¨ä¼šè¯ï¼š_ ** cï¼š\ users \ xx \ appdata \ local \ packages \ microsoft.microsoftEdge \ _xxx \ ac \ ac \ ac \ microsoftEdge \ microsoftEdge \ user \ user \ user \ default \ recureent \ recuce

## **Safari**

The databases can be found in `/Users/$User/Library/Safari`

æ•°æ®åº“å¯ä»¥åœ¨â€œ/user/$ user/library/safariâ€ä¸­æ‰¾åˆ°

* **History.db**: The tables `history_visits` _and_ `history_items` contains information about the history and timestamps.

*** history.db **ï¼šè¡¨`history_visits` _ and_'thistory_items`åŒ…å«æœ‰å…³å†å²è®°å½•å’Œæ—¶é—´æˆ³çš„ä¿¡æ¯ã€‚
  * `sqlite3 ~/Library/Safari/History.db "SELECT h.visit_time, i.url FROM history_visits h INNER JOIN history_items i ON h.history_item = i.id"`

*`s sqlite3ã€œ/library/safari/history.dbâ€œé€‰æ‹©h.visit_timeï¼Œi.url from stistory_visits h insion_items i history_items i on h.history_item = i.idâ€
* **Downloads.plist**: Contains the info about the downloaded files.

*** downloads.plist **ï¼šåŒ…å«æœ‰å…³ä¸‹è½½æ–‡ä»¶çš„ä¿¡æ¯ã€‚
* **Book-marks.plis**t: URLs bookmarked.
* **TopSites.plist**: List of the most visited websites that the user browses to.

*** topsites.plist **ï¼šç”¨æˆ·æµè§ˆæœ€è®¿é—®é‡æœ€å¤šçš„ç½‘ç«™çš„åˆ—è¡¨ã€‚
* **Extensions.plist**: To retrieve an old-style list of Safari browser extensions.

*** Extensions.plist **ï¼šæ£€ç´¢Safariæµè§ˆå™¨æ‰©å±•åçš„è€å¼åˆ—è¡¨ã€‚
  * `plutil -p ~/Library/Safari/Extensions/Extensions.plist| grep "Bundle Directory Name" | sort --ignore-case`

*`plutil -pã€œ/library/safari/extensions/extensions.plist | grepâ€œæ†ç»‘ç›®å½•åç§°â€ | æ’åº -  ignore-case`
  * `pluginkit -mDvvv -p com.apple.Safari.extension`
* **UserNotificationPermissions.plist**: Domains that are allowed to push notifications.

*** usernotificationpermissions.plist **ï¼šå…è®¸æ¨åŠ¨é€šçŸ¥çš„åŸŸã€‚
  * `plutil -p ~/Library/Safari/UserNotificationPermissions.plist | grep -a3 '"Permission" => 1'`

*``plutil -pã€œ/library/safari/usernotification permissions.plist | grep -a3'â€œè®¸å¯â€ => 1'```
* **LastSession.plist**: Tabs that were opened the last time the user exited Safari.

*** lastsession.plist **ï¼šä¸Šæ¬¡ç”¨æˆ·é€€å‡ºSafariæ—¶æ‰“å¼€çš„æ ‡ç­¾ã€‚
  * `plutil -p ~/Library/Safari/LastSession.plist | grep -iv sessionstate`
* **Browserâ€™s built-in anti-phishing:** `defaults read com.apple.Safari WarnAboutFraudulentWebsites`

***æµè§ˆå™¨çš„å†…ç½®åæ•æï¼š**``é»˜è®¤å€¼è¯»å–com.apple.safari warnaboutfroudultulenwebsites`
  * The reply should be 1 to indicate the setting is active

*ç­”å¤åº”ä¸º1è¡¨ç¤ºè®¾ç½®å¤„äºæ´»åŠ¨çŠ¶æ€

## Opera

The databases can be found in `/Users/$USER/Library/Application Support/com.operasoftware.Opera`

æ•°æ®åº“å¯ä»¥åœ¨`/user/$ user/library/application supports/com.operasoftware.opera`ä¸­æ‰¾åˆ°

Opera **stores browser history and download data in the exact same format as Google Chrome**. This applies to the file names as well as the table names.

Opera **å­˜å‚¨æµè§ˆå™¨å†å²è®°å½•ï¼Œå¹¶ä»¥ä¸Google Chrome **å®Œå…¨ç›¸åŒçš„æ ¼å¼ä¸‹è½½æ•°æ®ã€‚ è¿™é€‚ç”¨äºæ–‡ä»¶åä»¥åŠè¡¨åã€‚

* **Browserâ€™s built-in anti-phishing:** `grep --color 'fraud_protection_enabled' ~/Library/Application Support/com.operasoftware.Opera/Preferences`

***æµè§ˆå™¨çš„å†…ç½®åæ•æï¼š**``grep-color'fraud_protection_enabled'ã€œ/library/application supports/com.operasoftware.opera/preverences`
  * **fraud\_protection\_enabled** should be **true**

***æ¬ºè¯ˆ\ _ protection \ _enabled **åº”è¯¥** true **

{% hint style="danger" %}
<img src="../../../.gitbook/assets/image (307).png" alt="" data-size="original">

<img src =â€œ../../../ã€‚gitbook/assets/imageï¼ˆ307ï¼‰.pngâ€œ alt =â€â€œ data-size =â€ ointers =â€œ ointersâ€>

Through Security Skills as a Service, we help organizations to **defend against the Dark Hacking Arts**. Security Skills as a Service is an offensive cybersecurity consultancy model that combines an Intelligent Platform with the top-class, globally distributed, offensive security engineers, delivering **high-quality penetration testing results. Security Hubs** bring together offensive penetration testing tactics with human behavioral science, providing real-time insights into threat actors' tradecraft and a **complete assessment of any risks**.

é€šè¿‡å®‰å…¨æŠ€èƒ½ä½œä¸ºæœåŠ¡ï¼Œæˆ‘ä»¬å¸®åŠ©ç»„ç»‡**é˜²å¾¡é»‘æš—é»‘å®¢è‰ºæœ¯**ã€‚ å®‰å…¨æŠ€èƒ½ä½œä¸ºæœåŠ¡æ˜¯ä¸€ç§è¿›æ”»æ€§ç½‘ç»œå®‰å…¨å’¨è¯¢æ¨¡å‹ï¼Œå°†æ™ºèƒ½å¹³å°ä¸é¡¶çº§ï¼Œå…¨çƒåˆ†å¸ƒå¼ï¼Œè¿›æ”»æ€§å®‰å…¨å·¥ç¨‹å¸ˆç»“åˆåœ¨ä¸€èµ·ï¼Œæä¾›**é«˜è´¨é‡çš„æ¸—é€æµ‹è¯•ç»“æœã€‚ å®‰å…¨æ¢çº½**å°†è¿›æ”»æ€§æ¸—é€æµ‹è¯•ç­–ç•¥ä¸äººç±»è¡Œä¸ºç§‘å­¦ç»“åˆåœ¨ä¸€èµ·ï¼Œæä¾›å¯¹å¨èƒå‚ä¸è€…è´¸æ˜“å…‹ç½—å¤«ç‰¹ï¼ˆTradecraftï¼‰çš„å®æ—¶è§è§£ï¼Œå¹¶å¯¹ä»»ä½•é£é™©**è¿›è¡Œå®Œæ•´è¯„ä¼°ã€‚

{% embed url="https://securityhubs.io/" %}
{% endhint %}

<details>

<summary><strong>Support HackTricks and get benefits!</strong></summary>

<summary> <strong>æ”¯æŒhacktrickså¹¶è·å¾—å¥½å¤„ï¼</strong> </summary>

- Do you work in a **cybersecurity company**? Do you want to see your **company advertised in HackTricks**? or do you want to have access to the **latest version of the PEASS or download HackTricks in PDF**? Check the [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!

 - æ‚¨åœ¨**ç½‘ç»œå®‰å…¨å…¬å¸**å·¥ä½œå—ï¼Ÿ æ‚¨æ˜¯å¦æƒ³çœ‹åˆ°æ‚¨çš„**å…¬å¸åœ¨hacktricks **ä¸­åˆŠç™»å¹¿å‘Šï¼Ÿ è¿˜æ˜¯æ‚¨æƒ³è®¿é—®**æœ€æ–°ç‰ˆæœ¬çš„è±Œè±†æˆ–åœ¨pdf **ä¸­ä¸‹è½½hacktricksï¼Ÿ æ£€æŸ¥[**è®¢é˜…è®¡åˆ’**]ï¼ˆhttps://github.com/sponsors/carlospolopï¼‰ï¼

- Discover [**The PEASS Family**](https://opensea.io/collection/the-peass-family), our collection of exclusive [**NFTs**](https://opensea.io/collection/the-peass-family)

 - å‘ç°[**è±Œè±†å®¶åº­**]ï¼ˆhttps://opensea.io/collection/the-peass-familyï¼‰ï¼Œæˆ‘ä»¬çš„ç‹¬å®¶[** nfts **]ï¼ˆhttps://opensea.io/collectionï¼‰ /å®¶åº­å®¶åº­ï¼‰

- Get the [**official PEASS & HackTricks swag**](https://peass.creator-spring.com)

 - è·å–[**å®˜æ–¹è±Œè±†å’Œhacktricksèµƒç‰©**]ï¼ˆhttps://peass.creator-spring.comï¼‰

- **Join the** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** me on **Twitter** [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/carlospolopm)**.**

 -  **åŠ å…¥** [**ğŸ’¬**]ï¼ˆhttps://emojipedia.org/speech-balloon/ï¼‰[** discord group **]ï¼ˆhttps://discord.gg/hrep4ruj7fï¼‰æˆ–[ **ç”µæŠ¥ç»„**]ï¼ˆhttps://t.me/peassï¼‰æˆ–**åœ¨** Twitter ** [**ğŸ¦**]ï¼ˆhttps://github.com/carloppolop/hacktrickss on ** twitter **ï¼‰ /ree/7af18b62b3bdc423e114444444677a6a73d4043511e9/ \ [https:/emojipedia.org/bird/bird/readme.mdï¼‰eardme.mdï¼‰eghterme.mdï¼‰eghterme.mdï¼‰eghterme.mdï¼‰eghtemplopmbyth

- **Share your hacking tricks by submitting PRs to the** [**hacktricks github repo**](https://github.com/carlospolop/hacktricks)**.**

 -  **é€šè¿‡å°†PRSæäº¤ç»™** [** hacktricks github repo **]ï¼ˆhttps://github.com/carloppolop/hacktricksï¼‰**ã€‚

</details>
